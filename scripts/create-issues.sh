#!/usr/bin/env bash
# GitHub Issue 一括登録スクリプト（確認後に実行）
# 前提: gh がインストールされ、gh auth login 済みであること
set -e
cd "$(dirname "$0")/.."

echo "以下の Issue を GitHub に登録します。"
echo "リポジトリ: $(gh repo view --json nameWithOwner -q .nameWithOwner 2>/dev/null || echo 'current repo')"
echo "続行する場合は Enter、キャンセルは Ctrl+C"
read -r

gh issue create --title "[認証] Laravel Breeze 等でログイン・会員登録を導入する" --body "教員向けの会員登録・ログイン・ログアウトを実装する。未ログイン時はトップ（ログイン画面）へリダイレクト。認証後はメイン画面へ遷移。"
gh issue create --title "[画面] トップページ（ログイン画面）を実装する" --body "ルート / をログイン画面とする。メール（またはユーザー名）・パスワードでログイン。会員登録ページへのリンクを表示。"
gh issue create --title "[画面] 会員登録ページを実装する" --body "/register で会員登録フォームを表示。登録後はログイン状態にしてメイン画面へリダイレクト。"
gh issue create --title "[画面] メイン画面と設定画面のルート・レイアウトを用意する" --body "認証済みユーザー向けにメイン画面（/home）と設定画面（/settings）のルートを定義。共通レイアウト（ヘッダー・ナビ・ログアウト）を用意。"
gh issue create --title "[DB] クラス・座席レイアウト・クラスメイト用のマイグレーションを作成する" --body "seat_layouts, classmates, seat_constraints, current_seats 用テーブルを SQLite で作成。技術設計の DB 設計に沿う。"
gh issue create --title "[設定] クラス人数・座席数・配置を設定画面で登録できるようにする" --body "設定画面でクラスメイトの人数、座席の行数・列数を入力・保存。座席配置は縦×横で定義。"
gh issue create --title "[設定] 現在の席（出席番号↔席位置）を登録できるようにする" --body "出席番号と席位置の対応を設定画面で登録・編集。席替え前の状態を現在の席として保持。"
gh issue create --title "[設定] クラスメイトの出席番号・視力・「近くにしない」を登録できるようにする" --body "出席番号（1〜N）、視力（なし/軽度/重度）、近くにしない（別の出席番号を複数指定）を登録。"
gh issue create --title "[席替え] 制約なしのランダム席割り当てを実装する" --body "座席レイアウトとクラスメイト人数に基づき、出席番号を席にランダムに割り当てるサービスを実装。まずは視力・近くにしないは考慮しない。"
gh issue create --title "[席替え] 視力（重度・軽度）に応じて前列優先で割り当てる" --body "重度→最前列からランダム、軽度→その次に前列を優先してランダム、その他は残りをランダム。"
gh issue create --title "[席替え] 「近くにしない」制約を満たすように割り当てる" --body "指定ペアが隣接（上下左右）しないように席替え結果を生成。制約を満たせない場合は再試行またはエラー。"
gh issue create --title "[席替え] 現在の席と完全に同じ配置にならないようにする" --body "席替え結果が現在の席と1人も動いていない状態にならないようにする。同一の場合はシャッフルをやり直す（上限回数あり）。"
gh issue create --title "[メイン] 席替えを実行し、結果の席表を表示する" --body "メイン画面で席替え実行ボタンでアルゴリズムを実行。結果を席表（出席番号のグリッド）として表示。"
gh issue create --title "[メイン] 納得いかない場合に再シャッフルできるようにする" --body "表示中の席替え結果に対して再シャッフルボタン。再シャッフル時も直前の結果と完全同一にしない。"
gh issue create --title "[メイン] 確定した席配置を保存する" --body "保存ボタンで表示中の席表を現在の席としてDBに保存。次回の席替えでこの結果が前回として参照される。"
gh issue create --title "[メイン] 席表を印刷用に表示する（紙印刷想定）" --body "確定した席表を印刷しやすいレイアウトで表示（出席番号のみ）。CSS @media print で印刷用スタイル。"
gh issue create --title "[改善] 設定・席替えのバリデーションとエラー表示を整理する" --body "座席数とクラス人数の整合、制約で席替えが不可能な場合のメッセージなどを整理。"
gh issue create --title "[拡張] 1ユーザーで複数クラスを管理できるようにする（任意）" --body "classes テーブルを導入し、クラス切り替えで別クラスの席替え・設定ができるようにする。優先度低。" --label "enhancement"

echo "Issue の登録が完了しました。"
