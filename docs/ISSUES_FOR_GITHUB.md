# ランダム席替えアプリ - GitHub Issue 一覧（登録前確認用）

技術設計: [docs/TECHNICAL_DESIGN.md](TECHNICAL_DESIGN.md)

以下の Issue を GitHub に登録する想定です。**内容を確認のうえ、問題なければ「登録してよい」と指示してください。**

---

## Phase 1: 認証・基盤

### Issue 1: 認証基盤の導入（Laravel Breeze 等）

- **タイトル**: `[認証] Laravel Breeze 等でログイン・会員登録を導入する`
- **説明**:
  - 教員向けの会員登録・ログイン・ログアウトを実装する
  - 未ログイン時はトップ（ログイン画面）へリダイレクトする
  - 認証後はメイン画面（ダッシュボード）へ遷移する
- **受け入れ**: トップでログイン・会員登録ができ、未認証時はログインへ飛ぶこと

---

### Issue 2: トップページ（ログイン画面）

- **タイトル**: `[画面] トップページ（ログイン画面）を実装する`
- **説明**:
  - ルート `/` をログイン画面とする
  - メール（またはユーザー名）・パスワードでログインできる
  - 会員登録ページへのリンクを表示する
- **受け入れ**: ログインフォームが表示され、登録ページへ遷移できること

---

### Issue 3: 会員登録ページ

- **タイトル**: `[画面] 会員登録ページを実装する`
- **説明**:
  - `/register` で会員登録フォームを表示する
  - 登録後はログイン状態にしてメイン画面へリダイレクトする
- **受け入れ**: 登録完了後、メイン画面に遷移しログイン状態であること

---

### Issue 4: メイン画面・設定画面のランディング

- **タイトル**: `[画面] メイン画面と設定画面のルート・レイアウトを用意する`
- **説明**:
  - 認証済みユーザー向けにメイン画面（例: `/home`）と設定画面（例: `/settings`）のルートを定義する
  - 共通レイアウト（ヘッダー・ナビ・ログアウト）を用意する
- **受け入れ**: 認証後にメイン・設定へ遷移でき、レイアウトが共通であること

---

## Phase 2: DB・設定まわり

### Issue 5: SQLite 用マイグレーション（クラス・座席・クラスメイト）

- **タイトル**: `[DB] クラス・座席レイアウト・クラスメイト用のマイグレーションを作成する`
- **説明**:
  - まずは 1 ユーザー 1 クラスを想定し、`seat_layouts`（座席の行・列など）、`classmates`（出席番号・視力）、`seat_constraints`（近くにしないペア）、`current_seats`（現在の席）用のテーブルを SQLite で作成する
  - 技術設計の「4. DB 設計」に沿ったカラムとする
- **受け入れ**: `php artisan migrate` でエラーなくテーブルが作成されること

---

### Issue 6: 設定画面 - クラス人数・座席数・配置

- **タイトル**: `[設定] クラス人数・座席数・配置を設定画面で登録できるようにする`
- **説明**:
  - 設定画面で「クラスメイトの人数」「座席の行数・列数（または座席数）」を入力・保存できるようにする
  - 座席配置は縦×横で定義する（例: 5 行×6 列）
- **受け入れ**: 人数・座席数・配置を保存し、再表示できること

---

### Issue 7: 設定画面 - 現在の席の登録

- **タイトル**: `[設定] 現在の席（出席番号 ↔ 席位置）を登録できるようにする`
- **説明**:
  - 出席番号と席位置（行・列またはインデックス）の対応を設定画面で登録・編集できるようにする
  - 席替え前の状態を「現在の席」として保持する
- **受け入れ**: 現在の席を登録・更新・一覧表示できること

---

### Issue 8: 設定画面 - クラスメイト情報（出席番号・視力・近くにしない）

- **タイトル**: `[設定] クラスメイトの出席番号・視力・「近くにしない」を登録できるようにする`
- **説明**:
  - 出席番号（1〜N）を登録する
  - 視力: なし / 軽度 / 重度 を選択できるようにする
  - 「近くにしない」: 別の出席番号を複数指定できるようにする（相互でなくても可）
- **受け入れ**: 出席番号・視力・近くにしないが保存され、一覧・編集できること

---

## Phase 3: 席替えロジック

### Issue 9: 席替えアルゴリズム - 制約なしのランダム割り当て

- **タイトル**: `[席替え] 制約なしのランダム席割り当てを実装する`
- **説明**:
  - 座席レイアウトとクラスメイト人数に基づき、出席番号を席にランダムに割り当てるサービス（またはクラス）を実装する
  - まずは視力・「近くにしない」は考慮しない
- **受け入れ**: 同じ人数・同じ席数のとき、毎回異なる配置が得られること（単体テストで検証）

---

### Issue 10: 席替えアルゴリズム - 視力（重度・軽度）の反映

- **タイトル**: `[席替え] 視力（重度・軽度）に応じて前列優先で割り当てる`
- **説明**:
  - 視力「重度」のクラスメイトを最前列からランダムに割り当てる
  - 次に「軽度」を前列（2 列目等）を優先してランダムに割り当てる
  - その他は残りの席をランダムに割り当てる
- **受け入れ**: 重度→最前列、軽度→その次に前列が割り当てられること（テストで検証）

---

### Issue 11: 席替えアルゴリズム - 「近くにしない」の反映

- **タイトル**: `[席替え] 「近くにしない」制約を満たすように割り当てる`
- **説明**:
  - 指定されたペアが隣接（上下左右。必要なら斜めも）しないように席替え結果を生成する
  - 制約を満たせない場合は再試行またはエラーとする
- **受け入れ**: 近くにしないペアが隣に来ないこと（テストで検証）

---

### Issue 12: 席替えアルゴリズム - 前回と完全同一の席にしない

- **タイトル**: `[席替え] 現在の席と完全に同じ配置にならないようにする`
- **説明**:
  - 席替え結果が「現在の席」（current_seats）と 1 人も動いていない状態にならないようにする
  - 同一になった場合はシャッフルをやり直す（上限回数あり）
- **受け入れ**: 席替え実行後、少なくとも 1 人以上が前と異なる席になること（テストで検証）

---

## Phase 4: メイン画面・保存・印刷

### Issue 13: メイン画面 - 席替え実行・結果表示

- **タイトル**: `[メイン] 席替えを実行し、結果の席表を表示する`
- **説明**:
  - メイン画面で「席替え実行」ボタンを押すと、上記アルゴリズムで席替えを実行する
  - 結果を席表（出席番号のグリッド）として画面に表示する
- **受け入れ**: 実行後、制約を満たした席表が表示されること

---

### Issue 14: メイン画面 - 再シャッフル

- **タイトル**: `[メイン] 納得いかない場合に再シャッフルできるようにする`
- **説明**:
  - 表示中の席替え結果に対して「再シャッフル」ボタンを用意する
  - 再シャッフル時も「直前の結果と完全同一にしない」を満たす
- **受け入れ**: 再シャッフルで別の配置が表示され、同一にならないこと

---

### Issue 15: メイン画面 - 保存（確定）

- **タイトル**: `[メイン] 確定した席配置を保存する`
- **説明**:
  - 「保存」ボタンで、表示中の席表を「現在の席」として DB に保存する
  - 次回の席替えでは、この保存結果が「前回」として参照される
- **受け入れ**: 保存後、設定画面の「現在の席」や次回席替えの基準が更新されていること

---

### Issue 16: メイン画面 - 印刷用表示

- **タイトル**: `[メイン] 席表を印刷用に表示する（紙印刷想定）`
- **説明**:
  - 確定した席表を印刷しやすいレイアウトで表示する（出席番号のみ）
  - CSS `@media print` で印刷用スタイルを当てる
- **受け入れ**: ブラウザの印刷で、出席番号の席表が紙に印刷できること

---

## Phase 5: 追加・改善（任意）

### Issue 17: バリデーション・エラーハンドリングの整理

- **タイトル**: `[改善] 設定・席替えのバリデーションとエラー表示を整理する`
- **説明**:
  - 座席数とクラス人数の整合、制約で席替えが不可能な場合のメッセージなどを整理する
- **受け入れ**: 不正入力や制約違反時に適切なメッセージが表示されること

---

### Issue 18: 複数クラス対応（任意）

- **タイトル**: `[拡張] 1 ユーザーで複数クラスを管理できるようにする（任意）`
- **説明**:
  - `classes` テーブルを導入し、クラス切り替えで別クラスの席替え・設定ができるようにする
- **受け入れ**: クラスを切り替えてそれぞれ席替え・設定ができること（優先度低）

---

## 登録方法

### A. Python スクリプトで一括登録（推奨）

1. GitHub でリポジトリ `change-seats-app` を作成し、`git remote add origin https://github.com/<ユーザー名>/change-seats-app.git` で紐付ける
2. GitHub の Settings → Developer settings → Personal access tokens で **repo** スコープを持つトークンを作成する
3. リポジトリのルートで次を実行する（`<ユーザー名>` は実際の GitHub ユーザー名に置き換え）:

```bash
REPO=<ユーザー名>/change-seats-app GITHUB_TOKEN=ghp_xxxx python3 scripts/create-issues-api.py
```

### B. GitHub CLI（gh）で一括登録

`gh` をインストールし `gh auth login` 済みなら:

```bash
echo "" | ./scripts/create-issues.sh
```

### C. 手動で登録

このファイルの「タイトル」「説明」をコピーして、GitHub の Issue 作成画面から 1 件ずつ登録する。
